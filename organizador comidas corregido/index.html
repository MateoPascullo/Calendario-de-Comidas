<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Organizador de Comidas Semanales</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root { --primario:#8f9d68; --fondo:#f9f9f9; --borde:#ddd; --texto:#333; }
    body { font-family:'Segoe UI',sans-serif; background:var(--fondo); color:var(--texto); margin:0; padding:20px; line-height:1.6; }
    h1,h2,h3 { color:var(--primario); margin-bottom:10px; }
    select,button,input,textarea { margin:10px 0; padding:10px; width:100%; max-width:400px; border:1px solid var(--borde); border-radius:6px; font-size:16px; }
    button { background:var(--primario); color:#fff; border:none; cursor:pointer; transition:background .3s; }
    button:hover { background:#0088cc; }
    #mensaje { margin:20px; font-weight:bold; }
    table { width:100%; max-width:800px; margin:30px auto 0; border-collapse:collapse; }
    th,td { border:1px solid var(--borde); padding:12px; text-align:center; }
    td:hover { background:#f0f0f0; }
    td.selected { border:2px solid var(--primario); background:#e6f7ff; }
    .menu-eliminar { display:inline-block; margin-top:5px; background:#bbb; color:#fff; font-size:11px; padding:3px 6px; border-radius:3px; cursor:pointer; }
    .top-buttons { display:flex; flex-wrap:wrap; justify-content:center; gap:10px; margin-top:30px; }
    .top-buttons button { padding:8px 12px; font-size:14px; width:auto; }
    @media (max-width:600px){
      table, thead, tbody, th, td, tr { display:block; }
      thead{ display:none; }
      tr{ margin-bottom:15px; background:#fff; border:1px solid var(--borde); border-radius:6px; padding:10px; }
      td{ text-align:left; border:none; border-bottom:1px solid var(--borde); position:relative; padding-left:50%; }
      td::before{ position:absolute; top:10px; left:10px; width:45%; padding-right:10px; white-space:nowrap; content:attr(data-label); font-weight:bold; color:var(--primario); }
      td:last-child{ border-bottom:none; }
    }
    .plato-saludable{ width:400px; max-width:100%; height:auto; }
    .mensaje-toast{ position:fixed; bottom:20px; left:50%; transform:translateX(-50%); min-width:280px; max-width:90%; padding:12px 18px; border-radius:8px; font-size:15px; font-weight:500; color:#fff; box-shadow:0 4px 12px rgba(0,0,0,.2); display:none; z-index:1000; animation:fadein .3s ease, fadeout .3s ease 3.7s; }
    .mensaje-toast.exito{ background:#4CAF50; }
    .mensaje-toast.error{ background:#f44336; }
    @keyframes fadein { from{opacity:0; transform:translate(-50%,20px);} to{opacity:1; transform:translate(-50%,0);} }
    @keyframes fadeout { from{opacity:1;} to{opacity:0;} }

    /* Checkbox pegado al texto y con sombreadito */
.opciones-ensalada {
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  gap: 6px;
}

.opciones-ensalada .chip {
  display: inline-flex;
  align-items: center;
  gap: 6px;          /* separa solo 6px entre tilde y texto */
  margin: 0;
  padding: 6px 10px; /* ‚Äúpill‚Äù */
  border: 1px solid #ddd;
  border-radius: 10px;
  background: #f6f6f6;
  cursor: pointer;
  user-select: none;
}

.opciones-ensalada .chip input[type="checkbox"] {
  margin: 0;         /* quita m√°rgenes por defecto del navegador */
  transform: translateY(0); /* evita desalineaci√≥n vertical */
}
.opciones-ensalada {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 8px;
}

.opciones-ensalada .chip {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 10px;
  border: 1px solid #ccc;
  border-radius: 8px;
  background: #f9f9f9;
  cursor: pointer;
  font-size: 14px;
}

/* üëá forzamos el checkbox a mostrarse igual en iOS */
.opciones-ensalada .chip input[type="checkbox"] {
  appearance: auto;       /* asegura que Safari no los oculte */
  -webkit-appearance: checkbox; /* compatibilidad Safari */
  width: 18px;
  height: 18px;
  margin: 0;
}

.opciones-coccion {
  display: flex;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 10px;
}

.opciones-coccion label {
  display: flex;
  align-items: center;
  gap: 4px;
}

table {
  border-collapse: collapse;
  width: 100%;
  table-layout: fixed;   /* üëà fuerza que todas las columnas se adapten */
  word-wrap: break-word; /* üëà permite cortar palabras largas */
}

td {
  vertical-align: top;
  overflow-wrap: break-word; /* üëà corte de palabras si no entran */
  white-space: normal;       /* üëà permite salto de l√≠nea */
}
button {
  background: var(--primario); /* Verde base (#8f9d68) */
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  padding: 10px;
  transition: background .3s;
}

button:hover,
button:focus {
  background: #6f8632; /* un tono apenas m√°s oscuro que el base */
  outline: none;       /* saca el borde azul de focus */
}

.verduras-paren {    /*aca se puede achicar la letra de adentro de los paerentesis*/
  font-size: 12px;
  color: #555;
}



  </style>
</head>
<body>

  <h1>¬ø¬°Qu√© comemos!?</h1>
  <h2>Organizador de comidas semanal</h2>

  <div style="text-align:center; margin:20px 0;">
    <img src="plato-buen-comer.png" alt="Plato saludable" class="plato-saludable">
  </div>

  <h3 id="form-plato">Eleg√≠ los alimentos para tu plato</h3>


  <!-- Selector de Verduras y Ensaladas -->
  <select id="verdura">
    <option value="">-- Verduras y hortalizas --</option>
     
     <option value="Ens.(tomate,lechuga,cebolla)">Ens.(tomate,lechuga,cebolla)</option>
     <option value="Ens.(lechuga,tomate,cebolla,palta)">Ens.(lechuga,tomate,cebolla,palta)</option>
     <option value="Ens.(lechuga,zanahoria,repollo)">Ens.(lechuga,zanahoria,repollo)</option>
     <option value="Ens.(r√∫cula,zanahoria,repollo)">Ens.(r√∫cula,zanahoria,repollo)</option>
     <option value="Ens.(achicoria,zanahoria,repollo)">Ens.(achicoria,zanahoria,repollo)</option>
     <option value="Ens.(r√∫cula,t.cherry,palta)">Ens.(r√∫cula,t.cherry,palta)</option>
     <option value="Ens.(zanahoria,remolacha,repollo)">Ens.(zanahoria,remolacha,repollo)</option>
     <option value="Ens.(Apio,manzana verde, nueces)">Ens.(Apio,manzana verde, nueces)</option>
     <option value="Salteado(cebolla,pimiento,zanahoria)">Salteado(cebolla,pimiento,zanahoria)</option>
     <option value="Salteado(zucchini,berenjena,cebolla)">Salteado(zucchini,berenjena,cebolla)</option>
     <option value="Horno(cebolla,zanahoria,pimiento,calabaza)">Horno(cebolla,zanahoria,pimiento,calabaza)</option>
     <option value="Pur√© zapallo/calabaza">Pur√© zapallo/calabaza</option>

     

       <option value="ensaladas">ü•ó Arm√° tu ensalada</option>
  <!-- üëá opci√≥n ‚Äúcustom‚Äù para inyectar la ensalada armada -->
  <option id="verduraCustom" value="" style="display:none;"></option>
</select>
  </select>

 <div id="ensalada" class="subgrilla" style="display:none;">
  <h4>Arm√° tu ensalada</h4>

  <p>Eleg√≠ el tipo de cocci√≥n:</p>
  <div class="opciones-coccion">
    <label><input type="radio" name="coccion" value="Crudo"> Crudo</label>
    <label><input type="radio" name="coccion" value="Salteado"> Salteado</label>
    <label><input type="radio" name="coccion" value="Horno"> Horno</label>
    <label><input type="radio" name="coccion" value="Hervido"> Hervido</label>
  </div>

  <p>Seleccion√° las verduras:</p>
  <div class="opciones-ensalada">
    <label class="chip"><input type="checkbox" value="Lechuga">Lechuga</label>
    <label class="chip"><input type="checkbox" value="R√∫cula">R√∫cula</label>
    <label class="chip"><input type="checkbox" value="Achicoria">Achicoria</label>
    <label class="chip"><input type="checkbox" value="Espinaca">Espinaca</label>
    <label class="chip"><input type="checkbox" value="Acelga">Acelga</label>
    <label class="chip"><input type="checkbox" value="Repollo">Repollo</label>
    <label class="chip"><input type="checkbox" value="Tomate">Tomate</label>
    <label class="chip"><input type="checkbox" value="Tomate cherry">Tomate cherry</label>
    <label class="chip"><input type="checkbox" value="Cebolla">Cebolla</label>
    <label class="chip"><input type="checkbox" value="Cebolla verdeo">Cebolla verdeo</label>
    <label class="chip"><input type="checkbox" value="Puerro">Puerro</label>
    <label class="chip"><input type="checkbox" value="Ajo">Ajo</label>
    <label class="chip"><input type="checkbox" value="Pimiento">Pimiento</label>
    <label class="chip"><input type="checkbox" value="Zanahoria">Zanahoria</label>
    <label class="chip"><input type="checkbox" value="Remolacha">Remolacha</label>
    <label class="chip"><input type="checkbox" value="Zapallito">Zapallito</label>
    <label class="chip"><input type="checkbox" value="Zucchini">Zucchini</label>
    <label class="chip"><input type="checkbox" value="Berenjena">Berenjena</label>
    <label class="chip"><input type="checkbox" value="Pepino">Pepino</label>
    <label class="chip"><input type="checkbox" value="Calabaza">Calabaza</label>
    <label class="chip"><input type="checkbox" value="Zapallo">Zapallo</label>
    <label class="chip"><input type="checkbox" value="Arvejas">Arvejas</label>
    <label class="chip"><input type="checkbox" value="Chaucha">Chaucha</label>
    <label class="chip"><input type="checkbox" value="Brocoli">Brocoli</label>
    <label class="chip"><input type="checkbox" value="Coliflor">Coliflor</label>
    <label class="chip"><input type="checkbox" value="Alcaucil">Alcaucil</label>
    <label class="chip"><input type="checkbox" value="Apio">Apio</label>
  </div>

  <button type="button" onclick="copiarEnsalada()">Agregar ensalada</button>
</div>



  <select id="proteina">
    <option value="">-- Prote√≠nas --</option>  
     <option value="Milanesa vaca">Milanesa vaca</option>
     <option value="Milanesa pollo">Milanesa pollo</option>
     <option value="Milanesa cerdo">Milanesa cerdo</option>
     <option value="Milanesa pescado">Milanesa pescado</option>
     <option value="Milanesa de soja">Milanesa de soja</option>
     <option value="Hamburguesa vacuna">Hamburguesa vacuna</option>
     <option value="Medallon de pollo">Medallon de pollo</option>
     <option value="medallon-de-legumbre">Medallon de legumbre</option>
     <option value="nugget-de-pollo">Nugget de Pollo</option>
     <option value="bife-vacuno">Bife vacuno</option>
     <option value="pollo-al-horno">Pollo al horno</option>
     <option value="Pollo asado">Pollo asado</option>
     <option value="Filet pollo">Filet pollo</option>
     <option value="Filet pescado">Filet pescado</option>
     <option value="Costeleta vaca">Costeleta vaca</option>
     <option value="Costeleta cerdo">Costeleta cerdo</option>
     <option value="Huevo duro">Huevo duro</option>
     <option value="huevo revuelto">Huevo revuelto</option>
     <option value="huevo a la plancha">Huevo a la plancha</option>
     <option value="jamon cocido crudo">Jamon cocido/crudo</option>
  </select>

  <select id="hidrato">
    <option value="">-- Hidratos de carbono --</option>
      <option value="Arroz blanco">Arroz blanco</option>
      <option value="Arroz integral yamani">Arroz integral/yaman√≠</option>
      <option value="Fideos">Fideos</option>
      <option value="Medallon de legumbre">Medallon de legumbre</option>
     <option value="Pure de papa">Pure de papa</option>
     <option value="Papa al horno">Papa al horno</option>
     <option value="Batata al horno">Batata al horno</option>
     <option value="Choclo">Choclo</option>
     <option value="Quinoa">Qu√≠noa</option>
     <option value="Cuscus">Cusc√∫s</option>
     <option value="Trigo-burgol">Trigo burgol</option>
     <option value="Lentejas">Lentejas</option>
     <option value="Garbanzos">Garbanzos</option>
     <option value="Porotos">Porotos</option>
  </select>

  <select id="completo">
    <option value="">-- Plato completo (opcional) --</option>
      <option value="Tarta de espinaca,queso,cebolla,puerro">Tarta de espinaca,queso,cebolla,puerro</option>
     <option value="tarta capresse">Tarta capresse</option>
    <option value="Tarta de zapallito,queso,huevo, cebolla">Tarta de zapallito,queso,huevo, cebolla</option>
     <option value="tarta de atun">Tarta de at√∫n</option>
     <option value="Pastel de papa,zapallo,carne picada">Pastel de papa,zapallo,carne picada</option>
     <option value="guiso de lentejas">Guiso de lentejas</option>
     <option value="pata muslo + verduras al horno">Pata muslo + verduras al horno</option>
     <option value="Pescado al paquete con verduras">Pescado al paquete con verduras</option>
     <option value="Omeltte de queso y espinaca + Ens. Lenteja y tomate">Omeltte de queso y espinaca + Ens. Lenteja y tomate</option>
     <option value="Pasta rellena con salsa( tomate, bolognesa o mixta)">Pasta rellena con salsa( tomate, bolognesa o mixta)</option>
     <option value="Wok de verduras y fideos">Wok de verduras y fideos</option>
     <option value="Wok de verduras y pollo">Wok de verduras y pollo</option>
     <option value="Fajitas de pollo y verdura">Fajitas de pollo y verdura</option>
  </select>

  <button onclick="validarPlato()">Validar y asignar</button>

  <h2>üóìÔ∏è Calendario semanal</h2>
  <p>Hac√© click en una comida para seleccionarla y despu√©s click en otra celda para intercambiarla o moverla. Toc√° en "Eliminar" para borrar un alimento.</p>

  <table id="calendario">
    <thead><tr><th>D√≠a</th><th>Almuerzo</th><th>Cena</th></tr></thead>
    <tbody id="calendario-body"></tbody>
  </table>

  <div class="top-buttons">
    <button onclick="descargarPDF()">üì• Descargar men√∫ semanal (PDF)</button>
    <button onclick="resetearCalendario()">üîÑ Resetear calendario</button>
    <button onclick="window.open('https://forms.gle/ddyvdbKZqHhuM8W77','_blank')">Validar nuevo Alimento o Receta</button>
    <button onclick="window.open('index-vegetariano.html','_blank')">Opci√≥n calendario Vegetariano</button>
  </div>

  <script>

    document.getElementById('verdura').addEventListener('change', function () {
  const isSalad = this.value === 'ensaladas';
  document.getElementById('ensalada').style.display = isSalad ? 'block' : 'none';
});

function copiarEnsalada() {
  // Obtener cocci√≥n seleccionada
  const coccion = document.querySelector('input[name="coccion"]:checked');
  if (!coccion) {
    mostrarMensaje('‚ùå Falta elegir m√©todo de cocci√≥n.','error');
    return;
  }

  // Obtener verduras seleccionadas
  const checks = document.querySelectorAll('#ensalada input[type="checkbox"]:checked');
  const seleccion = Array.from(checks).map(c => c.value);
  if (!seleccion.length) {
    mostrarMensaje('‚ùå Seleccion√° al menos una verdura.','error');
    return;
  }

  // Armar string final con cocci√≥n + verduras en par√©ntesis
  const finalStr = `${coccion.value} (<span class="verduras-paren">${seleccion.join(', ')}</span>)`;

  // Inyectar en opci√≥n custom
  const optCustom = document.getElementById('verduraCustom');
  optCustom.value = `${coccion.value} (${seleccion.join(', ')})`; // valor plano
  optCustom.innerHTML = `ü•ó Ensalada: ${finalStr}`;
  optCustom.style.display = '';
  optCustom.selected = true;

  // Limpiar selecci√≥n
  document.getElementById('ensalada').style.display = 'none';
  document.querySelectorAll('#ensalada input[type="checkbox"]').forEach(c => c.checked = false);
  document.querySelectorAll('#ensalada input[name="coccion"]').forEach(r => r.checked = false);
}



    const dias = ['Lunes','Martes','Mi√©rcoles','Jueves','Viernes']; // ‚úÖ solo lunes a viernes
    let calendario = {}; let seleccion = null;
    dias.forEach(dia => calendario[dia] = { almuerzo:null, cena:null });

    function getSeleccionados(){
      const vb=document.getElementById('verdura').value;
      const sub=document.getElementById('ensalada').value;
      const verdura=(vb==='ensaladas' && sub)?sub:vb;
      return { verdura, proteina:document.getElementById('proteina').value, hidrato:document.getElementById('hidrato').value, completo:document.getElementById('completo').value };
    }

    function limpiarSelects(){ ['verdura','proteina','hidrato','completo'].forEach(id=>document.getElementById(id).value=''); document.getElementById('ensalada').style.display='none'; }

    function validarPlato() {
  const s = getSeleccionados();
  let valido = false, platoFinal = '';

  // ‚úÖ Reglas de combinaci√≥n
  if (s.completo && !s.verdura && !s.proteina && !s.hidrato) {
    // Plato completo solo
    valido = true;
    platoFinal = s.completo;
  } 
  else if (s.verdura && s.proteina && s.hidrato && !s.completo) {
    // Verdura + Prote√≠na + Hidrato
    valido = true;
    platoFinal = `${s.verdura}, ${s.proteina}, ${s.hidrato}`;
  } 
  else if (s.verdura && s.proteina && !s.hidrato && !s.completo) {
    // Verdura + Prote√≠na
    valido = true;
    platoFinal = `${s.verdura}, ${s.proteina}`;
  } 
  else if (s.verdura && s.hidrato && !s.proteina && !s.completo) {
    // Verdura + Hidrato
    valido = true;
    platoFinal = `${s.verdura}, ${s.hidrato}`;
  }

  if (valido) {
    if (seleccion) {
      // üëâ Asignar directamente a la celda seleccionada
      const { dia, tipo } = seleccion;
      const otroTipo = (tipo === 'almuerzo') ? 'cena' : 'almuerzo';

      // No repetir almuerzo = cena en el mismo d√≠a
      if (calendario[dia][otroTipo] === platoFinal) {
        mostrarMensaje(`‚ùå No pod√©s repetir "${platoFinal}" en ${dia}.`, 'error');
      }
      // No m√°s de 2 veces por semana
      else if (contarRepeticiones(platoFinal) >= 2 && calendario[dia][tipo] !== platoFinal) {
        mostrarMensaje(`‚ùå El plato "${platoFinal}" ya fue asignado 2 veces esta semana.`, 'error');
      }
      else {
        calendario[dia][tipo] = platoFinal;
        actualizarCalendario();
        mostrarMensaje(`‚úÖ Plato agregado en ${dia} (${tipo}).`, 'exito');
      }
      seleccion = null;
      limpiarSelects();
    } else {
      // üëâ Si no hay celda seleccionada, usar asignaci√≥n aleatoria con l√≠mite de 2
      const ok = asignarAcalendario(platoFinal);
      if (ok) {
        mostrarMensaje('‚úÖ Plato v√°lido. Asignado correctamente al calendario.', 'exito');
      } else {
        mostrarMensaje(`‚ùå El plato "${platoFinal}" ya fue asignado 2 veces esta semana.`, 'error');
      }
      limpiarSelects();
    }
  } else {
    // Mensaje espec√≠fico si eligieron prote√≠na + hidrato sin verdura
    if (!s.verdura && s.proteina && s.hidrato) {
      mostrarMensaje('‚ùå Faltan verduras u hortalizas en el plato.', 'error');
    } else {
      mostrarMensaje('‚ùå Combinaci√≥n no v√°lida. Volv√© a intentarlo.', 'error');
    }
  }
}
function contarRepeticiones(plato) {
  let rep = 0;
  dias.forEach(d => {
    if (calendario[d].almuerzo === plato) rep++;
    if (calendario[d].cena === plato) rep++;
  });
  return rep;
}



    function asignarAcalendario(plato){
      let rep=0; dias.forEach(d=>{ if(calendario[d].almuerzo===plato) rep++; if(calendario[d].cena===plato) rep++; });
      if(rep>=2) return false;
      let disp=[...dias];
      while(disp.length){
        let dia=disp[Math.floor(Math.random()*disp.length)];
        let comida=Math.random()<.5?'almuerzo':'cena';
        if(!calendario[dia][comida]){
          if(calendario[dia].almuerzo!==plato && calendario[dia].cena!==plato){
            calendario[dia][comida]=plato; actualizarCalendario(); return true;
          }
        }
        disp.splice(disp.indexOf(dia),1);
      }
      return false;
    }

    function resetearCalendario(){ dias.forEach(d=>calendario[d]={almuerzo:null,cena:null}); actualizarCalendario(); }

    function actualizarCalendario(){
      guardarCalendario();
      const cuerpo=document.getElementById('calendario-body'); cuerpo.innerHTML='';
      const hoy=new Date(); let indiceHoy=hoy.getDay()-1; 
      if(indiceHoy<0||indiceHoy>4) indiceHoy=null; // ‚úÖ no resaltar finde
      dias.forEach((dia,i)=>{
        const esHoy = i===indiceHoy;
        cuerpo.innerHTML+=`
          <tr${esHoy?' style="background-color:#fff8dc;"':''}>
            <td data-label="D√≠a">${dia}</td>
            <td data-label="Almuerzo" onclick="seleccionarCelda('${dia}','almuerzo')">${crearContenidoCelda(dia,'almuerzo')}</td>
            <td data-label="Cena" onclick="seleccionarCelda('${dia}','cena')">${crearContenidoCelda(dia,'cena')}</td>
          </tr>`;
      });
    }

    function crearContenidoCelda(dia, tipo) {
  const plato = calendario[dia][tipo];
  if (!plato) {
    return '<span style="font-size:12px; color:#999;">Haga click para agregar un plato</span>';
  }
  return `${plato} <span class="menu-eliminar" role="button" tabindex="0" aria-label="Eliminar plato" onclick="eliminarPlato(event,'${dia}','${tipo}')">Eliminar</span>`;
}

    function eliminarPlato(e,dia,tipo){ e.stopPropagation(); calendario[dia][tipo]=null; actualizarCalendario(); }

  function seleccionarCelda(dia, tipo) {
  // Quitar resaltado previo
  document.querySelectorAll('#calendario-body td').forEach(td => td.classList.remove('selected'));

  // Si todav√≠a no hay selecci√≥n, marcar esta y (si est√° vac√≠a) scrollear al formulario
  if (!seleccion) {
    seleccion = { dia, tipo };
    marcarCeldaSeleccionada(dia, tipo);
    if (!calendario[dia][tipo]) {
      document.getElementById('form-plato').scrollIntoView({ behavior: 'smooth' });
    }
    return;
  }

  // Ya hab√≠a una selecci√≥n previa (origen)
  const o = seleccion;                // { dia, tipo } seleccionado antes
  const pO = calendario[o.dia][o.tipo]; // plato en origen
  const pD = calendario[dia][tipo];     // plato en destino

  // Si clickeaste la misma celda, cancelar selecci√≥n
  if (o.dia === dia && o.tipo === tipo) {
    seleccion = null;
    actualizarCalendario();
    return;
  }

  // Si el origen estaba vac√≠o (seleccionaste una celda vac√≠a primero),
  // simplemente mover la selecci√≥n a la nueva celda
  if (!pO) {
    seleccion = { dia, tipo };
    marcarCeldaSeleccionada(dia, tipo);
    if (!pD) {
      document.getElementById('form-plato').scrollIntoView({ behavior: 'smooth' });
    }
    return;
  }

  // Probar movimiento/intercambio en una copia para validar duplicado dentro del d√≠a
  const tmp = JSON.parse(JSON.stringify(calendario));
  tmp[dia][tipo] = pO;           // mover plato de origen a destino
  tmp[o.dia][o.tipo] = pD;       // y lo que hab√≠a en destino (o nada) pasa al origen

  const noDupMismoDia = d => {
    const a = tmp[d].almuerzo, c = tmp[d].cena;
    return !(a && c && a === c);
  };

  if (!noDupMismoDia(dia) || !noDupMismoDia(o.dia)) {
    mostrarMensaje('‚ùå No se puede repetir el mismo plato en el mismo d√≠a.', 'error');
    seleccion = null;
    actualizarCalendario();
    return;
  }

  // Aplicar cambio (move/swap) y limpiar selecci√≥n
  calendario = tmp;
  seleccion = null;
  actualizarCalendario();
}




    function marcarCeldaSeleccionada(dia,tipo){ document.querySelectorAll('#calendario-body tr').forEach(f=>{ const c=f.children; if(c[0].innerText===dia){ if(tipo==='almuerzo') c[1].classList.add('selected'); if(tipo==='cena') c[2].classList.add('selected'); } }); }

    function guardarCalendario(){ localStorage.setItem('calendario',JSON.stringify(calendario)); }
    function cargarCalendario(){ const g=localStorage.getItem('calendario'); if(g){ try{ calendario=JSON.parse(g);}catch(e){console.error("Error al cargar calendario:",e);} } }

    window.onload=()=>{ cargarCalendario(); actualizarCalendario(); };

    document.getElementById('verdura').addEventListener('change', function(){ const ens=document.getElementById('ensalada'); if(this.value==='ensaladas'){ ens.style.display='block'; } else { ens.style.display='none'; ens.value=''; } });

    function mostrarMensaje(texto,tipo){ const m=document.getElementById('mensaje'); m.className="mensaje-toast"; m.classList.add(tipo); m.innerText=texto; m.style.display='block'; setTimeout(()=>{ m.style.display='none'; },4000); }
  </script>

  <div id="mensaje" class="mensaje-toast"></div>

  

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  async function descargarPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    doc.setFont("helvetica", "bold");
    doc.setFontSize(16);
    doc.text("üç¥ Men√∫ semanal", 20, 20);

    doc.setFont("helvetica", "normal");
    doc.setFontSize(12);

    let y = 40;
    dias.forEach(dia => {
      const almuerzo = calendario[dia].almuerzo || "-";
      const cena = calendario[dia].cena || "-";
      doc.text(`${dia}:`, 20, y);
      doc.text(`Almuerzo: ${almuerzo}`, 40, y + 10);
      doc.text(`Cena: ${cena}`, 40, y + 20);
      y += 40;
    });

    doc.save("menu-semanal.pdf");
  }
</script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>

<script>
  function descargarPDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();

    // T√≠tulo
    doc.setFont("helvetica", "bold");
    doc.setFontSize(18);
    doc.text("üç¥ Men√∫ semanal", 14, 20);

    // Armar la tabla
    const cabecera = [["D√≠a", "Almuerzo", "Cena"]];
    const filas = dias.map(dia => [
      dia,
      calendario[dia].almuerzo || "-",
      calendario[dia].cena || "-"
    ]);

    doc.autoTable({
      head: cabecera,
      body: filas,
      startY: 30,
      theme: "grid",
      headStyles: { fillColor: [143, 157, 104] }, // verde oliva del dise√±o
      styles: { halign: "center" }
    });

    // Guardar el PDF
    doc.save("menu-semanal.pdf");
  }
</script>
</body>
</html>





