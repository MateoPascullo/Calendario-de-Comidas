<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Plato Resuelto - Vegetariano</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link href="https://fonts.googleapis.com/css2?family=Courgette&family=Raleway:wght@400;600&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="css/style.css?v=10">

  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#8f9d68">

  <!-- Favicons -->
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32.png">
  <link rel="shortcut icon" href="favicon-32.png">

  <!-- Para iPhone -->
  <link rel="apple-touch-icon" sizes="180x180" href="favicon-180.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">

  <!-- Open Graph -->
  <meta property="og:title" content="Plato Resuelto - Vegetariano">
  <meta property="og:description" content="Organiz√° tus comidas con un calendario simple y √°gil.">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://platoresuelto.com/index-vegetariano.html">
  <meta property="og:image" content="https://platoresuelto.com/og-image-1200x630.png">
  <meta property="og:image:width" content="1200">
  <meta property="og:image:height" content="630">

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Plato Resuelto - Vegetariano">
  <meta name="twitter:description" content="Organiz√° tus comidas con un calendario simple y √°gil.">
  <meta name="twitter:image" content="https://platoresuelto.com/og-image-1200x630.png">

</head>




<!-- Tutorial inicial -->
<div id="tutorial" class="tutorial-overlay" style="display:none;">
  <div class="tutorial-box">
    <div id="tutorial-indicator" class="tutorial-step-indicator"></div>
    <div id="tutorial-step"></div>
    <div class="tutorial-buttons">
      <button id="tutorial-prev" style="display:none;"></button>
      <button id="tutorial-next"></button>
    </div>
  </div>
</div>

<script src="js/tutorial.js" defer></script>



<body>
   
   <button id="logoutBtn" style="display:none">Cerrar sesi√≥n</button>
   

   <!-- üîí contenido protegido -->
   <div id="contenido" style="display:none;">
     <!-- boton de whatsapp -->
    <div class="btn-whatsapp-top">
  <a href="https://wa.me/?text=üî• Prob√° esta app de calendario de comidas! üëâ https://platoresuelto.com" 
     target="_blank" 
     class="btn-calendario btn-whatsapp">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" class="icono-whatsapp">
      <path fill="white" d="M16 .667C7.64.667.667 7.64.667 16c0 2.828.736 5.59 2.14 8.027L.667 31.333l7.493-2.093A15.27 15.27 0 0 0 16 31.333C24.36 31.333 31.333 24.36 31.333 16S24.36.667 16 .667zm0 27.733c-2.56 0-5.04-.693-7.2-2l-.52-.307-4.453 1.24 1.2-4.587-.307-.547A12.29 12.29 0 0 1 3.707 16c0-6.76 5.533-12.293 12.293-12.293 3.28 0 6.36 1.28 8.68 3.6a12.27 12.27 0 0 1 3.613 8.693c0 6.76-5.533 12.293-12.293 12.293z"/>
      <path fill="white" d="M24.067 19.88c-.4-.2-2.36-1.16-2.72-1.293-.36-.133-.627-.2-.893.2-.267.4-1.027 1.293-1.267 1.56-.227.267-.467.3-.867.1-.4-.2-1.693-.627-3.227-2-1.187-1.04-1.987-2.32-2.213-2.72-.227-.4-.024-.627.173-.827.173-.173.4-.467.6-.7.2-.233.267-.4.4-.667.133-.267.067-.5-.033-.7-.1-.2-.893-2.147-1.227-2.947-.32-.773-.647-.667-.893-.68h-.76c-.253 0-.667.093-1.013.467-.347.373-1.333 1.293-1.333 3.147 0 1.853 1.36 3.64 1.547 3.893.187.253 2.68 4.093 6.493 5.747.907.393 1.613.627 2.16.8.907.293 1.733.253 2.387.153.727-.107 2.36-.96 2.693-1.893.333-.933.333-1.733.233-1.893-.093-.16-.333-.253-.733-.453z"/>
    </svg>
    Compart√≠ la app
  </a>
</div>

     <div class="btn-calendario-container">
    <a href="index.html" class="btn-calendario">Volver a calendario tradicional</a>
   </div>

   <a href="#calendario" id="btnHoy" class="btn-calendario btn-flotante">¬øYa elegiste tu men√∫ de hoy?</a>
   
   <a href="javascript:void(0)" id="btnListaCompras" class="btn-calendario btn-flotante btn-lista-compras">üõí Gener√° tu lista de compras!</a>
 
   <h1>PlatoResuelto!</h1>
  <h2>Vegetariano</h2>
  <h2>Organiz√° tus comidas</h2>

  <div style="text-align:center; margin:20px 0;">
    <img src="plato-buen-comer-bis.jpg" alt="Plato saludable" class="plato-saludable">
  </div>

 <!-- scroll de arma tu ensalada-->
  <h3 id="plato-semana">Arm√° un plato para la semana</h3>




  <!-- Selector de Verduras y Ensaladas -->
   <select id="verdura">
    <option value=""> Verduras y hortalizas </option>
      <option value="Ens.(lechuga,tomate,cebolla)">Ens.(lechuga,tomate,cebolla)</option>
     <option value="Ens.(lechuga,tomate,cebolla,palta)">Ens.(lechuga,tomate,cebolla,palta)</option>
     <option value="Ens.(lechuga,zanahoria,repollo)">Ens.(lechuga,zanahoria,repollo)</option>
     <option value="Ens.(rucula,zanahoria,repollo)">Ens.(r√∫cula,zanahoria,repollo)</option>
     <option value="Ens.(achicoria,zanahoria,repollo)">Ens.(achicoria,zanahoria,repollo)</option>
     <option value="Ens.(rucula,t.cherry,palta)">Ens.(r√∫cula,t.cherry,palta)</option>
     <option value="Ens.(zanahoria,remolacha,repollo)">Ens.(zanahoria,remolacha,repollo)</option>
     <option value="Ens.(apio,manzana-verde,nueces)">Ens.(Apio,manzana verde, nueces)</option>
     <option value="Salteado (cebolla,pimiento,zanahoria)">Salteado(cebolla,pimiento,zanahoria)</option>
     <option value="Salteado (zucchini,berenjena,cebolla)">Salteado(zucchini,berenjena,cebolla)</option>
     <option value="Al horno (cebolla,zanahoria,pimiento,calabaza)">Al horno(cebolla,zanahoria,pimiento,calabaza)</option>
     <option value="pure zapallo-calabaza">Pur√© zapallo/calabaza</option>
  
      <option value="ensaladas">ü•ó Arm√° tu ensalada</option>
  <!-- üëá opci√≥n ‚Äúcustom‚Äù para inyectar la ensalada armada -->
  <option id="verduraCustom" value="" style="display:none;"></option>
  </select>

  
</select>

 <div id="ensalada" class="subgrilla" style="display:none;">
  <!-- üîπ Nueva fila con t√≠tulo + bot√≥n chiquito -->
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <h4 style="margin:0;">Arm√° tu ensalada</h4>
    
  </div>

  <p>Eleg√≠ el tipo de cocci√≥n:</p>
  <div class="opciones-coccion">
    <label><input type="radio" name="coccion" value="Crudo"> Crudo</label>
    <label><input type="radio" name="coccion" value="Salteado"> Salteado</label>
    <label><input type="radio" name="coccion" value="Horno"> Horno</label>
    <label><input type="radio" name="coccion" value="Hervido"> Hervido</label>
  </div>

  <p>Seleccion√° las verduras:</p>
  <div class="opciones-ensalada">
   <label class="chip"><input type="checkbox" value="Lechuga">Lechuga</label>
    <label class="chip"><input type="checkbox" value="R√∫cula">R√∫cula</label>
    <label class="chip"><input type="checkbox" value="Achicoria">Achicoria</label>
    <label class="chip"><input type="checkbox" value="Espinaca">Espinaca</label>
    <label class="chip"><input type="checkbox" value="Acelga">Acelga</label>
    <label class="chip"><input type="checkbox" value="Repollo">Repollo</label>
    <label class="chip"><input type="checkbox" value="Tomate">Tomate</label>
    <label class="chip"><input type="checkbox" value="Tomate cherry">Tomate cherry</label>
    <label class="chip"><input type="checkbox" value="Cebolla">Cebolla</label>
    <label class="chip"><input type="checkbox" value="Cebolla verdeo">Cebolla verdeo</label>
    <label class="chip"><input type="checkbox" value="Puerro">Puerro</label>
    <label class="chip"><input type="checkbox" value="Ajo">Ajo</label>
    <label class="chip"><input type="checkbox" value="Pimiento">Pimiento</label>
    <label class="chip"><input type="checkbox" value="Zanahoria">Zanahoria</label>
    <label class="chip"><input type="checkbox" value="Remolacha">Remolacha</label>
    <label class="chip"><input type="checkbox" value="Zapallito">Zapallito</label>
    <label class="chip"><input type="checkbox" value="Zucchini">Zucchini</label>
    <label class="chip"><input type="checkbox" value="Berenjena">Berenjena</label>
    <label class="chip"><input type="checkbox" value="Pepino">Pepino</label>
    <label class="chip"><input type="checkbox" value="Calabaza">Calabaza</label>
    <label class="chip"><input type="checkbox" value="Zapallo">Zapallo</label>
    <label class="chip"><input type="checkbox" value="Arvejas">Arvejas</label>
    <label class="chip"><input type="checkbox" value="Chaucha">Chaucha</label>
    <label class="chip"><input type="checkbox" value="Brocoli">Brocoli</label>
    <label class="chip"><input type="checkbox" value="Coliflor">Coliflor</label>
    <label class="chip"><input type="checkbox" value="Alcaucil">Alcaucil</label>
    <label class="chip"><input type="checkbox" value="Apio">Apio</label>
  </div>

  <button type="button" onclick="copiarEnsalada()" class="btn-mini">Agregar ensalada</button>
</div>



  <select id="proteina">
    <option value=""> Prote√≠nas vegetarianas </option>
       
       <option value="Huevo (Duro/ Revuelto/ a la plancha)">Huevo (Duro/ Revuelto/ a la plancha)</option>
       <option value="Medallon de legumbre">Medallon de legumbre</option>
       <option value="Milanesa de legumbre">Milanesa de legumbre</option>
       <option value="lentejas">Lentejas</option>
       <option value="garbanzos">Garbanzos</option>
       <option value="porotos">Porotos</option>
       <option value="Soja texturizada">Soja texturizada</option>
       <option value="tofu">Tofu</option>
       <option value="tempeh">Tempeh</option>
       <option value="Ricota">Ricota</option>
       <option value="Quesos">Quesos</option>
  </select>

  <select id="hidrato">
    <option value=""> Hidratos de carbono </option>
     
    <option value="Arroz(Blanco/ integral/ Yamani)">Arroz(Blanco/ integral/ Yamani)</option>
     <option value="Fideos">Fideos</option>
     <option value="Pure de papa">Pure de papa</option>
     <option value="Papa al horno">Papa al horno</option>
     <option value="Batata al horno">Batata al horno</option>
     <option value="Choclo">Choclo</option>
     <option value="Quinoa">Qu√≠noa</option>
     <option value="Cuscus">Cusc√∫s</option>
     <option value="Trigo-burgol">Trigo burgol</option>
  </select>

  <select id="completo">
    <option value=""> Plato completo </option>
    <option value="Tarta de espinaca, queso, cebolla y puerro">Tarta de espinaca, queso, cebolla y puerro</option>
    <option value="Tarta capresse ( T. cherry, q. cremoso, albahaca, aceitunas negras)">Tarta capresse ( T. cherry, q. cremoso, albahaca, aceitunas negras)</option>
    <option value="Tarta de zapallito, queso, huevo y cebolla">Tarta de zapallito, queso, huevo y cebolla</option>
    <option value="Milanesas de berenjena gratinadas + guacamole">Milanesas de berenjena gratinadas + guacamole</option>
    <option value="Pastel de papa y zapallo">Pastel de papa y zapallo</option>
    <option value="Omeltte de queso y espinaca + Ens. Lenteja y tomate">Omeltte de queso y espinaca + Ens. Lenteja y tomate</option>
    <option value="Crepes de espinaca,cebolla, c.verdeo + salsa de morr√≥n y crema">Crepes des espinaca,cebolla, c.verdeo + salsa de morr√≥n y crema</option>
    <option value="Wok de fideos de arroz + verduras(pimiento,cebolla,zucchini,zanahoria)">Wok de fideos de arroz + verduras(pimiento,cebolla,zucchini,zanahoria)</option>
    <option value="Fajitas de verduras varias(cebolla, pimiento, zanahoria, berenjena)">Fajitas de verduras varias(cebolla, pimiento, zanahoria, berenjena)</option>
    <option value="Torrejas de arroz + ensalada de zanahoria , rucula, tomate y huevo">Torrejas de arroz + ensalada de zanahoria , rucula, tomate y huevo</option>
     <option value="Ravioles con salsa de tomate">Ravioles con salsa de tomate</option>
     <option value="Ravioles con salsa mixta">Ravioles con salsa mixta</option>
     <option value="√ëoquis con salsa de tomate">√ëoquis con salsa de tomate</option>
     <option value="√ëoquis con salsa mixta">√ëoquis con salsa mixta</option>
     
  </select>

  <button onclick="validarPlato()">Agreg√° el plato al calendario</button>
      
      
      <h2>üóìÔ∏è Calendario semanal</h2>
  

  <table id="calendario">
    <thead><tr><th>D√≠a</th><th>Almuerzo</th><th>Cena</th></tr></thead>
    <tbody id="calendario-body"></tbody>
  </table>

  <div class="top-buttons">
    
    <button onclick="resetearCalendario()">üîÑ Resetear calendario</button>

    <button onclick="generarCalendarioAleatorioVeg()">üé≤ Generar semana aleatoria</button>
    
    <button onclick="descargarPDF()">üì• Descarg√° tu men√∫ semanal (PDF)</button>
    
    <button onclick="window.open('https://forms.gle/ddyvdbKZqHhuM8W77','_blank')">Sugerinos un nuevo alimento o Plato</button>

     <div class="btn-calendario-container">
       <a href="javascript:void(0)" onclick="mostrarTutorial()" class="btn-calendario">üìò Ver tutorial</a>
      <a href="nosotros.html" class="btn-calendario">Sobre nosotros</a>
     </div>
    
  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>


<script src="js/compartido.js" defer></script>
<script src="js/vegetariano.js" defer></script>
<script src="js/pwa.js" defer></script>

<div id="mensaje" class="mensaje-toast"></div>

<!-- Modal para Lista de Compras -->
<div id="modalListaCompras" class="modal-lista-compras" style="display:none;">
  <div class="modal-contenido">
    <div class="modal-header">
      <h2>üõí Tu Lista de Compras</h2>
      <button id="cerrarModal" class="btn-cerrar">√ó</button>
    </div>
    <div class="modal-body">
      <div id="listaComprasContenido"></div>
    </div>
    <div class="modal-footer">
      <button id="descargarLista" class="btn-descargar">üì• Descargar Lista</button>
    </div>
  </div>
</div>

</div> <!-- üîí cierra contenido protegido -->


<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.2.1/firebase-app.js";
  import { getAuth, onAuthStateChanged, signInWithPopup, GoogleAuthProvider, signOut } 
    from "https://www.gstatic.com/firebasejs/12.2.1/firebase-auth.js";
  import { getFirestore, doc, setDoc, getDoc, getDocFromServer } 
    from "https://www.gstatic.com/firebasejs/12.2.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyBgyXUiZPdYlWQBclhhH70mfRuIXIuw2EE",
    authDomain: "plato-resuelto.firebaseapp.com",
    projectId: "plato-resuelto",
    storageBucket: "plato-resuelto.firebasestorage.app",
    messagingSenderId: "11080746612",
    appId: "1:11080746612:web:22f488078f01def94ff321",
    measurementId: "G-16RQJ5KB0H"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const provider = new GoogleAuthProvider();
  const db = getFirestore(app);

  const contenido = document.getElementById("contenido");

  // ---------- LISTA DE COMPRAS ----------
  async function guardarListaCompras(user) {
    try {
      // Obtener la lista actual desde la variable global
      const lista = window.listaComprasFirestore || [];
      await setDoc(doc(db, "calendarios", user.uid), { listaComprasVeg: lista }, { merge: true });
      console.log("Lista de compras vegetariana guardada en Firestore ‚úÖ");
    } catch (e) { console.error("Error guardando listaComprasVeg:", e); }
  }

  async function cargarListaCompras(user) {
    try {
      const snap = await getDoc(doc(db, "calendarios", user.uid));
      if (snap.exists() && Array.isArray(snap.data().listaComprasVeg)) {
        // Actualizar la variable global en lugar de localStorage
        window.listaComprasFirestore = snap.data().listaComprasVeg;
        if (typeof cargarListaComprasADOMSiExiste === "function") {
          cargarListaComprasADOMSiExiste();
        }
        console.log("Lista de compras vegetariana cargada ‚úÖ");
      }
    } catch (e) { console.error("Error cargando listaComprasVeg:", e); }
  }

  // ---------- DETECTAR SESI√ìN ----------
  onAuthStateChanged(auth, async (user) => {
    const originalGuardar = window.guardarCalendario;
    const originalCargar  = window.cargarCalendario;

    if (user) {
      contenido.style.display = "block";

      // override globales
      window.guardarCalendario = async function () {
        try {
          await setDoc(doc(db, "calendarios", user.uid), { vegetariano: calendario }, { merge: true });
          console.log("Calendario vegetariano guardado en Firestore ‚úÖ");
        } catch (e) { console.error("Error guardando en Firestore:", e); }
        if (typeof originalGuardar === "function") originalGuardar();
      };

      window.cargarCalendario = async function () {
        try {
          const snap = await getDocFromServer(doc(db, "calendarios", user.uid));
          if (snap.exists() && snap.data().vegetariano) {
            calendario = snap.data().vegetariano;
            console.log("Calendario vegetariano cargado desde Firestore ‚úÖ");
          }
        } catch (e) {
          console.warn("Fallo getDocFromServer, uso getDoc:", e);
          const snap = await getDoc(doc(db, "calendarios", user.uid));
          if (snap.exists() && snap.data().vegetariano) {
            calendario = snap.data().vegetariano;
          }
        }
        actualizarCalendario();
      };

      await cargarCalendario();
      await cargarListaCompras(user);

      document.addEventListener("change", () => guardarCalendario(user));
      document.addEventListener("click", (e) => {
        if (e.target.tagName === "BUTTON") guardarCalendario(user);
      });
      document.addEventListener("listaCompras:cambiada", () => guardarListaCompras(user));

    } else {
      contenido.style.display = "none";
      if (originalGuardar) window.guardarCalendario = originalGuardar;
      if (originalCargar)  window.cargarCalendario  = originalCargar;
      // opcional: redirigir
      // window.location.href = "index.html";
    }
  });
</script>



















